:root {
    --bg-dark: #1a1714;
    --bg-card: #2a2520;
    --bg-panel: #232019;
    --gold: #c9a227;
    --gold-light: #e8c547;
    --gold-dark: #8a6f1a;
    --cream: #f4e9d5;
    --cream-dark: #d4c9b5;
    --red: #8b2635;
    --green: #2d5a3d;
    --blue: #2a4a6b;
    --text: #e8e0d0;
    --text-muted: #9a9080;
    --border: #3a352f;
}

* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: 'Crimson Text', Georgia, serif; background: var(--bg-dark); color: var(--text); min-height: 100vh; }

/* Buttons */
.btn { font-family: 'Cinzel', serif; background: var(--gold-dark); color: var(--cream); border: none; padding: 1rem 2.5rem; font-size: 1rem; cursor: pointer; text-transform: uppercase; letter-spacing: 0.1em; transition: all 0.3s; }
.btn:hover { background: var(--gold); color: var(--bg-dark); }
.btn:disabled { opacity: 0.5; cursor: not-allowed; }
.btn-secondary { background: transparent; border: 1px solid var(--border); color: var(--text-muted); }
.btn-secondary:hover { border-color: var(--gold); color: var(--gold); background: transparent; }
.btn-small { padding: 0.5rem 1rem; font-size: 0.85rem; }

/* Game Selector */
.screen { display: none; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; padding: 2rem; }
.screen.active { display: flex; }
.screen h1 { font-family: 'Cinzel', serif; font-size: 2.5rem; color: var(--gold); margin-bottom: 0.5rem; text-transform: uppercase; letter-spacing: 0.2em; }
.screen .subtitle { font-size: 1.2rem; color: var(--text-muted); margin-bottom: 3rem; font-style: italic; }
.game-slots { display: flex; gap: 1.5rem; margin-bottom: 2rem; }
.game-slot { background: var(--bg-card); border: 2px solid var(--border); padding: 2rem 3rem; cursor: pointer; transition: all 0.3s; text-align: center; min-width: 180px; }
.game-slot:hover, .game-slot.active { border-color: var(--gold); }
.game-slot h3 { font-family: 'Cinzel', serif; font-size: 1.3rem; color: var(--gold); margin-bottom: 0.5rem; }
.game-slot .status { font-size: 0.9rem; color: var(--text-muted); }
.game-slot .status.has-data { color: var(--cream); }
.game-actions { display: flex; gap: 1rem; }

/* Setup */
.setup-nations { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin-bottom: 2rem; }
.setup-nation { background: var(--bg-card); border: 1px solid var(--border); padding: 1.5rem; text-align: center; }
.setup-nation h4 { font-family: 'Cinzel', serif; color: var(--cream); margin-bottom: 1rem; }
.setup-toggle { display: flex; gap: 0.5rem; justify-content: center; }
.toggle-btn { padding: 0.5rem 1rem; font-family: 'Cinzel', serif; font-size: 0.8rem; background: var(--bg-panel); border: 1px solid var(--border); color: var(--text-muted); cursor: pointer; text-transform: uppercase; }
.toggle-btn.active { background: var(--gold-dark); border-color: var(--gold); color: var(--cream); }
.setup-row { display: flex; gap: 1.5rem; margin-bottom: 2rem; }
.setup-field label { display: block; font-size: 0.9rem; color: var(--text-muted); margin-bottom: 0.5rem; }
.setup-field input, .setup-field select { padding: 0.75rem 1rem; font-family: 'Crimson Text', serif; font-size: 1rem; background: var(--bg-panel); border: 1px solid var(--border); color: var(--cream); }

/* Main App */
.app { display: none; flex-direction: column; min-height: 100vh; }
.app.active { display: flex; }

/* Top Bar */
.top-bar { background: var(--bg-panel); border-bottom: 1px solid var(--border); padding: 0.75rem 1.5rem; display: flex; justify-content: space-between; align-items: center; }
.top-bar-left { display: flex; align-items: center; gap: 1.5rem; }
.app-title { font-family: 'Cinzel', serif; font-size: 1rem; color: var(--gold); text-transform: uppercase; letter-spacing: 0.1em; }
.stat-pills { display: flex; gap: 1rem; }
.stat-pill { display: flex; align-items: center; gap: 0.4rem; font-size: 0.9rem; }
.stat-pill .label { color: var(--text-muted); }
.stat-pill .value { color: var(--gold); font-family: 'Cinzel', serif; cursor: pointer; }
.stat-pill .value:hover { color: var(--gold-light); }
.phase-badge { background: var(--gold-dark); color: var(--cream); padding: 0.4rem 1rem; font-family: 'Cinzel', serif; text-transform: uppercase; font-size: 0.8rem; }

/* Main Layout */
.main-layout { display: flex; flex: 1; overflow: hidden; }

/* Log Panel */
.log-panel { width: 260px; background: var(--bg-panel); border-right: 1px solid var(--border); display: flex; flex-direction: column; }
.log-panel h3 { font-family: 'Cinzel', serif; font-size: 0.85rem; color: var(--gold); text-transform: uppercase; padding: 1rem; border-bottom: 1px solid var(--border); }
.log-entries { flex: 1; overflow-y: auto; padding: 0.5rem; }
.log-entry { padding: 0.6rem; border-bottom: 1px solid var(--border); font-size: 0.8rem; }
.log-meta { color: var(--text-muted); font-size: 0.7rem; }
.log-nation { color: var(--gold); font-weight: 600; }
.log-action { color: var(--cream-dark); }
.empty-log { text-align: center; padding: 2rem; color: var(--text-muted); font-style: italic; }

/* Decision Area */
.decision-area { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
.nation-bar { background: var(--bg-card); border-bottom: 1px solid var(--border); padding: 0.75rem 1.5rem; display: flex; gap: 0.5rem; }
.nation-tab { padding: 0.5rem 1.25rem; background: transparent; border: 1px solid var(--border); color: var(--text-muted); font-family: 'Cinzel', serif; font-size: 0.85rem; cursor: pointer; text-transform: uppercase; }
.nation-tab:hover { border-color: var(--gold-dark); color: var(--cream); }
.nation-tab.active { background: var(--gold-dark); border-color: var(--gold); color: var(--cream); }
.nation-tab.is-player { opacity: 0.3; cursor: default; }
.nation-tab.done { background: var(--green); border-color: var(--green); opacity: 0.7; }

.decision-content { flex: 1; overflow-y: auto; padding: 2rem; }

/* Card Input */
.card-input-area { max-width: 500px; margin: 0 auto; }
.card-input-label { font-family: 'Cinzel', serif; font-size: 1rem; color: var(--gold); margin-bottom: 0.75rem; text-transform: uppercase; }
.card-input-wrapper { position: relative; }
.card-input { width: 100%; padding: 1rem 1.5rem; font-family: 'Crimson Text', serif; font-size: 1.1rem; background: var(--bg-card); border: 2px solid var(--border); color: var(--cream); outline: none; }
.card-input:focus { border-color: var(--gold); }
.autocomplete-list { position: absolute; top: 100%; left: 0; right: 0; background: var(--bg-panel); border: 1px solid var(--gold-dark); border-top: none; max-height: 200px; overflow-y: auto; z-index: 100; display: none; }
.autocomplete-list.show { display: block; }
.autocomplete-item { padding: 0.75rem 1.5rem; cursor: pointer; display: flex; justify-content: space-between; }
.autocomplete-item:hover { background: var(--bg-card); }

/* Decision Tree */
.decision-tree { max-width: 550px; margin: 0 auto; }
.decision-actions { display: flex; justify-content: flex-end; gap: 0.5rem; margin-bottom: 1rem; }
.tree-card { background: var(--bg-card); border: 2px solid var(--gold-dark); padding: 1rem 1.25rem; margin-bottom: 1.5rem; display: flex; justify-content: space-between; align-items: center; }
.tree-card-name { font-family: 'Cinzel', serif; font-size: 1.1rem; color: var(--cream); }
.tree-card-cp { color: var(--gold); }

.priority-section { margin-bottom: 1.5rem; }
.priority-header { font-family: 'Cinzel', serif; font-size: 0.95rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.1em; padding-bottom: 0.5rem; border-bottom: 1px solid var(--border); display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.75rem; }
.priority-header.active { color: var(--gold); border-color: var(--gold-dark); }
.priority-header.done { color: var(--green); }
.status-dot { width: 8px; height: 8px; border-radius: 50%; background: currentColor; }
.priority-header.active .status-dot { animation: pulse 1.5s infinite; }
@keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.4; } }

.priority-content { padding-left: 1rem; border-left: 2px solid var(--border); }
.priority-content.dimmed { opacity: 0.4; }

/* Steps */
.step-item { background: var(--bg-panel); padding: 0.75rem 1rem; margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.75rem; transition: opacity 0.3s; }
.step-item.action { border-left: 3px solid var(--green); background: rgba(45, 90, 61, 0.15); }
.step-item.impossible { opacity: 0.4; }

.step-item.selectable {
    cursor: pointer;
    transition: background 0.2s, border-color 0.2s;
    border-right: 1px solid transparent;
}
.step-item.selectable:not(.impossible):hover {
    background: rgba(201, 162, 39, 0.2);
    border-right: 3px solid var(--gold);
}
.step-item.impossible.selectable {
    cursor: not-allowed;
}

.step-icon { font-size: 1rem; min-width: 20px; text-align: center; }
.step-text { flex: 1; color: var(--cream-dark); }
.step-text strong { color: var(--cream); }

.question-box { background: var(--bg-card); padding: 1rem; margin: 1rem 0; }
.question-text { color: var(--cream); margin-bottom: 0.75rem; }
.question-btns { display: flex; gap: 0.5rem; }
.q-btn { flex: 1; padding: 0.75rem; font-family: 'Cinzel', serif; font-size: 0.85rem; border: 1px solid var(--border); background: var(--bg-panel); color: var(--cream); cursor: pointer; text-transform: uppercase; }
.q-btn:hover { border-color: var(--gold); }
.q-btn.yes:hover { background: var(--green); border-color: var(--green); }
.q-btn.no:hover { background: var(--red); border-color: var(--red); }

/* Dice */
.dice-box { display: inline-flex; align-items: center; gap: 0.5rem; background: var(--bg-card); padding: 0.5rem 0.75rem; border: 1px solid var(--gold-dark); margin: 0.5rem 0; }
.dice { width: 32px; height: 32px; background: var(--gold-dark); border-radius: 4px; display: flex; align-items: center; justify-content: center; font-family: 'Cinzel', serif; font-size: 1.1rem; color: var(--cream); font-weight: bold; }
.dice-label { color: var(--text-muted); font-size: 0.85rem; }

/* Action Output */
.action-box { background: var(--green); padding: 1.25rem; margin-top: 1rem; }
.action-box h4 { font-family: 'Cinzel', serif; font-size: 0.85rem; color: var(--cream); text-transform: uppercase; margin-bottom: 0.5rem; }
.action-text { color: var(--cream); font-size: 1.05rem; line-height: 1.5; }
.confirm-btn { margin-top: 1rem; width: 100%; background: var(--gold-dark); border: none; padding: 0.75rem; font-family: 'Cinzel', serif; color: var(--cream); cursor: pointer; text-transform: uppercase; }
.confirm-btn:hover { background: var(--gold); color: var(--bg-dark); }

/* State Panel */
.state-panel { width: 220px; background: var(--bg-panel); border-left: 1px solid var(--border); padding: 1rem; overflow-y: auto; }
.state-panel h3 { font-family: 'Cinzel', serif; font-size: 0.85rem; color: var(--gold); text-transform: uppercase; margin-bottom: 1rem; }
.state-card { background: var(--bg-card); border: 1px solid var(--border); padding: 0.6rem; margin-bottom: 0.6rem; font-size: 0.8rem; }
.state-card.is-player { opacity: 0.4; }
.state-header { display: flex; justify-content: space-between; margin-bottom: 0.4rem; }
.state-nation { font-family: 'Cinzel', serif; color: var(--cream); }
.state-badge { font-size: 0.6rem; padding: 0.1rem 0.3rem; background: var(--gold-dark); color: var(--cream); text-transform: uppercase; }
.state-badge.player { background: var(--border); }
.state-stats { display: flex; gap: 0.3rem; margin-bottom: 0.4rem; }
.state-stat { flex: 1; text-align: center; background: var(--bg-panel); padding: 0.3rem; }
.state-stat .lbl { font-size: 0.6rem; color: var(--text-muted); display: block; }
.state-stat .val { font-family: 'Cinzel', serif; color: var(--cream); cursor: pointer; }
.state-stat .val:hover { color: var(--gold); }
.state-flags { display: flex; flex-wrap: wrap; gap: 0.2rem; }
.flag { font-size: 0.65rem; padding: 0.15rem 0.3rem; background: var(--bg-panel); color: var(--text-muted); cursor: pointer; }
.flag.on { background: var(--gold-dark); color: var(--cream); }

/* Phase Overlay */
.phase-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.8); display: none; align-items: center; justify-content: center; z-index: 500; }
.phase-overlay.show { display: flex; }
.phase-modal { background: var(--bg-card); border: 2px solid var(--gold); padding: 2rem; max-width: 450px; width: 90%; }
.phase-modal h2 { font-family: 'Cinzel', serif; font-size: 1.4rem; color: var(--gold); text-transform: uppercase; margin-bottom: 1.5rem; text-align: center; }
.phase-item { display: flex; gap: 0.5rem; padding: 0.4rem 0; color: var(--cream-dark); }
.phase-item .icon { color: var(--gold); }
.hc-list { background: var(--bg-panel); padding: 0.75rem; margin: 1rem 0; }
.hc-row { display: flex; justify-content: space-between; padding: 0.25rem 0; }
.hc-nation { color: var(--gold); }
.hc-pos { color: var(--cream); }
.phase-btn { width: 100%; margin-top: 1rem; }

/* Dimming during decision */
.app.deciding .log-panel, .app.deciding .state-panel, .app.deciding .nation-bar { opacity: 0.25; pointer-events: none; }

/* Phase-based dimming */
.app[data-phase="prep"] .main-layout, .app[data-phase="diplomacy"] .main-layout { opacity: 0.2; pointer-events: none; }

.empty-state { text-align: center; padding: 3rem; color: var(--text-muted); }
.empty-state .icon { font-size: 2.5rem; margin-bottom: 0.5rem; opacity: 0.4; }
